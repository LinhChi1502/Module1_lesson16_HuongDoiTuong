<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Car Game</title>
    <style>
        canvas {
            border: solid 3px #000;
        }

    </style>
</head>
<body onkeydown="gameBoard.moveCar(event)">
<canvas id="myCanvas" width="500px" height="500px"></canvas>
<script>
    const GAMEBOARD_WIDTH = 500;
    const GAMEBOARD_HEIGHT = 500;

    const ORIENTATION_LEFT = "left";
    const ORIENTATION_RIGHT = "right";
    const ORIENTATION_UP = "up";
    const ORIENTATION_DOWN = "down";

    const CAR_WIDTH = 50;
    const CAR_HEIGHT = 50;

    const DEFAULT_CAR_POSITION_X = 100;
    const DEFAULT_CAR_POSITION_Y = 100;
    const DEFAULT_CAR_ORIENTATION = ORIENTATION_UP;
    const DEFAULT_CAR_SPEED = 20;

    function Car() {
        this.xPos = DEFAULT_CAR_POSITION_X;
        this.yPos = DEFAULT_CAR_POSITION_Y;
        this.orientation = ORIENTATION_UP;
        this.speed = DEFAULT_CAR_SPEED;
        this.image = this.orientation + ".png";

        this.buildImage = function () {
            return this.image;
        }
        this.buildImage();
        this.move = function () {
            switch (this.orientation) {
                case ORIENTATION_UP:
                    this.yPos -= this.speed;
                    break;
                case ORIENTATION_DOWN:
                    this.yPos += this.speed;
                    break;
                case ORIENTATION_RIGHT:
                    this.xPos += this.speed;
                    break;
                case ORIENTATION_LEFT:
                    this.xPos -= this.speed;
                    break;
            }
            this.buildImage();
        }
        this.turn = function(orientation){
            this.orientation = orientation;
            this.buildImage();
        };
        this.show = function (ctx) {
            let image = new Image();
            let xPos = this.xPos;
            let yPos = this.yPos;

            image.width = CAR_WIDTH;
            image.height = CAR_HEIGHT;
            image.onload = function () {
                ctx.drawImage(image, xPos, yPos, image.width, image.height);
            }
            image.src = this.image;
        }

    }

    function GameBoard() {
        this.car = new Car();
        this.ctx = undefined;
        this.start = function () {
            this.ctx = document.getElementById("myCanvas").getContext("2d");
            this.car.show(this.ctx);
        }
        this.render = function () {
            this.ctx.clearRect(0, 0, GAMEBOARD_WIDTH, GAMEBOARD_HEIGHT);
            this.car.show(this.ctx);
        };
        this.moveCar = function (event) {
            let orientation = 0;
            switch (event) {
                case 37:
                    orientation = ORIENTATION_LEFT;
                    break;
                case 38:
                    orientation = ORIENTATION_UP;
                    break;
                case 39:
                    orientation = ORIENTATION_RIGHT;
                    break;
                case 40:
                    orientation = ORIENTATION_DOWN;
                    break;
            }
            if (orientation) {
                if (this.car.orientation !== orientation) {
                    this.car.orientation = orientation;
                } else {
                    this.car.move();
                }
                this.render();
            }

        }
    }

    let gameBoard = new GameBoard();
    gameBoard.start();

</script>
</body>
</html>